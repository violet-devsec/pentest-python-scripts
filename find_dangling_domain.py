import dns.resolver
from termcolor import colored

# Finds all sub-domains dangling or not
def is_dangling(domain):
    try:
        answers = dns.resolver.resolve(domain)
    except (dns.resolver.NoAnswer, dns.resolver.NXDOMAIN):
        return True
    else:
        return False
    
# Finds all sub-domain registered under this DNS record    
def find_cnames_recursive(domain):
    cnames = []
    try:
        answers = dns.resolver.resolve(domain, 'CNAME')
        for rdata in answers:
            cname = str(rdata.target).rstrip('.')
            cnames.append(cname)
            cnames += find_cnames_recursive(cname)
            print(f"All CNAME records of {domain} in loop: {cnames}")
    except Exception as e:
        print(f"CNAME find ends.")
    return cnames